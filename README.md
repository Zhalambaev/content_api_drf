# Content API

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –Ω–∞ Django REST Framework —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Celery.

---

## üìã –£—Å–ª–æ–≤–∏–µ –∑–∞–¥–∞—á–∏

### –ú–æ–¥–µ–ª—å –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏:
- **–°—Ç—Ä–∞–Ω–∏—Ü–∞ (Page)**
- **–í–∏–¥–µ–æ (Video)**
  - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã: `video_url`, `subtitles_url`
- **–ê—É–¥–∏–æ (Audio)**
  - —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã: `audio_url`, `text`
- –£ –≤—Å–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞:
  - `title` (–∑–∞–≥–æ–ª–æ–≤–æ–∫)
  - `counter` (—Å—á—ë—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤)
  - `order_id` (–ø–æ—Ä—è–¥–æ–∫ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ)
- –°–æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–≤—è–∑–∞–Ω–æ –ª—é–±–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤.
- –í –±—É–¥—É—â–µ–º –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è–µ–º—ã –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
1. –°–¥–µ–ª–∞—Ç—å API –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö —Å—Ç—Ä–∞–Ω–∏—Ü.
   - –î–æ–ª–∂–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è –ø–∞–≥–∏–Ω–∞—Ü–∏—è (–ø–æ—Å—Ç—Ä–∞–Ω–∏—á–Ω–∞—è –≤—ã–¥–∞—á–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤)
   - –í –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å—Å—è URL –Ω–∞ API —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
   (–ø—É–Ω–∫—Ç ‚Ññ2).
2. –°–¥–µ–ª–∞—Ç—å API –ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
   - –ü–æ–º–∏–º–æ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤ –æ—Ç–≤–µ—Ç–µ –¥–æ–ª–∂–Ω—ã —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –≤—Å–µ –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã–µ –∫
   —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ–±—ä–µ–∫—Ç—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –≤ –≤–∏–¥–µ –≤–ª–æ–∂–µ–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã-—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
   –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –æ–±—ä–µ–∫—Ç–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ —Å–æ –≤—Å–µ–º–∏ –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏, –≤–∫–ª—é—á–∞—è
   —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ.
3. –ü—Ä–∏ –æ–±—Ä–∞—â–µ–Ω–∏–∏ –∫ API —Å –¥–µ—Ç–∞–ª—è–º–∏ –æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ —Å—á–µ—Ç—á–∏–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤ –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞  –∫–æ–Ω—Ç–µ–Ω—Ç–∞, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω–æ–≥–æ –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ, –¥–æ–ª–∂–µ–Ω —É–≤–µ–ª–∏—á–∏—Ç—Å—è –Ω–∞ –µ–¥–∏–Ω–∏—Ü—É.
   - –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ –¥–∞–Ω–Ω–æ–µ API –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è —Å—É—â–µ—Å—Ç–≤–µ–Ω–Ω–∞—è, –ø–æ—ç—Ç–æ–º—É –∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ —Ñ–æ–Ω–æ–≤–æ–π –∑–∞–¥–∞—á–µ.
   - –í–∞–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ, —á—Ç–æ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ —Å—á–µ—Ç—á–∏–∫–∞ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç—å —Å—Ç—Ä–æ–≥–æ –∞—Ç–æ–º–∞—Ä–Ω–æ. –¢–æ –µ—Å—Ç—å, –µ—Å–ª–∏ –¥–≤–µ –∑–∞–¥–∞—á–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è—é—Ç —Å—á–µ—Ç—á–∏–∫ –æ–¥–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞, —Ç–æ –Ω–∞ –≤—ã—Ö–æ–¥–µ –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—Å—è "+2".
4. –ó–∞–≤–µ–¥–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü –∏ –ø—Ä–∏–≤—è–∑–∫–∞ –∫ –Ω–∏–º –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –¥–æ–ª–∂–Ω–∞ –≤—ã–ø–æ–ª–Ω—è—Ç—Å—è —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É.
   - –î–æ–ª–∂–µ–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è –ø–æ–∏—Å–∫ –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É (title) —Å—Ç—Ä–∞–Ω–∏—Ü –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (–ø–æ —á–∞—Å—Ç–∏—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é –æ—Ç –Ω–∞—á–∞–ª–∞).
   - –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø—Ä–∏–≤—è–∑–∫—É –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤ –≤–∏–¥–µ inline-–±–ª–æ–∫–æ–≤ –≤ —Ä–∞–∑–¥–µ–ª–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å—Ç—Ä–∞–Ω–∏—Ü–µ–π (Page) –≤ –∞–¥–º–∏–Ω–∫–µ.
   - –ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ, —á—Ç–æ–±—ã –±—ã–ª–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∑–∞–¥–∞–≤–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ –≤—ã–¥–∞—á–∏ –≤ API –æ–±—ä–µ–∫—Ç–æ–≤, –ø—Ä–∏–≤—è–∑–∞–Ω–Ω—ã—Ö –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ.
5. –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã:
   - –º–∏–Ω–∏–º—É–º –ø–æ –æ–¥–Ω–æ–º—É –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–º—É —Ç–µ—Å—Ç—É –Ω–∞ –∫–∞–∂–¥—ã–π API.

---

## ‚úÖ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è

- **–ú–æ–¥–µ–ª–∏**
  - `Page` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞
  - `Video` - –∫–æ–Ω—Ç–µ–Ω—Ç —Ç–∏–ø–∞ –≤–∏–¥–µ–æ
  - `Audio` - –∫–æ–Ω—Ç–µ–Ω—Ç —Ç–∏–ø–∞ –∞—É–¥–∏–æ
  - –æ–±—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –≤—ã–Ω–µ—Å–µ–Ω –≤ `BaseContent` (title, counter, order_id).
- **API**
  - `GET /api/pages/` - —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü (—Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π, detail_url).
  - `GET /api/pages/<id>/` - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–≤–µ—Å—å –∫–æ–Ω—Ç–µ–Ω—Ç, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –ø–æ `order_id`).
- **–°—á—ë—Ç—á–∏–∫–∏**
  - —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ Celery-–∑–∞–¥–∞—á—É `counters_for_page`;
  - –∞—Ç–æ–º–∞—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—á—ë—Ç—á–∏–∫–æ–≤ (—á–µ—Ä–µ–∑ `F`-–≤—ã—Ä–∞–∂–µ–Ω–∏—è).
- **–ê–¥–º–∏–Ω–∫–∞**
  - –ø–æ–∏—Å–∫ –ø–æ `title`;
  - inline-–±–ª–æ–∫–∏ –¥–ª—è –≤–∏–¥–µ–æ –∏ –∞—É–¥–∏–æ –≤–Ω—É—Ç—Ä–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã;
  - `order_id` –∑–∞–¥–∞—ë—Ç—Å—è –ø—Ä—è–º–æ –≤ –∞–¥–º–∏–Ω–∫–µ.
- **–ü–∞–≥–∏–Ω–∞—Ü–∏—è**
  - —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π –∫–ª–∞—Å—Å `PagePagination` (10 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é, `?page_size` –¥–æ 100).
- **–¢–µ—Å—Ç—ã**
  - `PagesListApiTest` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–∏—Å–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü (–ø–∞–≥–∏–Ω–∞—Ü–∏—è, detail_url).
  - `PageDetailApiTest` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ—Ç–∞–ª—å–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–∫–æ–Ω—Ç–µ–Ω—Ç, —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞, –≤—ã–∑–æ–≤ Celery).
  - Celery –≤—ã–∑–æ–≤—ã –∑–∞–º–æ–∫–∞–Ω—ã (`@patch`), —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ç–µ—Å—Ç–∞–º –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è –±–µ–∑ –±—Ä–æ–∫–µ—Ä–∞.

---

## üöÄ –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   pip install -r requirements.txt

2. –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏:
   ```bash
   python manage.py migrate

3. –ó–∞–ø—É—Å—Ç–∏—Ç—å Redis:
   ```bash
   redis-server

4. –ó–∞–ø—É—Å—Ç–∏—Ç—å Celery worker:
   ```bash
   celery -A content_api worker -l info

5. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
   ```bash
   python manage.py runserver

## üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

1. –í–≤–µ—Å—Ç–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª
   ```bash
   python manage.py test content_api_app

## üìÇ –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

- **GET /api/pages/** - —Å–ø–∏—Å–æ–∫ —Å—Ç—Ä–∞–Ω–∏—Ü —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
- **GET /api/pages/<id>/** - –¥–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ —Å –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º
